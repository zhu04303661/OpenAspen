# DWSIMçƒ­åŠ›å­¦è®¡ç®—ç®—æ³•å®Œæ•´å‚è€ƒæ‰‹å†Œ
## ç®—æ³•å…¬å¼ã€æè¿°ä¸åº”ç”¨æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0 Complete  
**ç¼–åˆ¶æ—¥æœŸ**: 2024å¹´  
**é€‚ç”¨èŒƒå›´**: DWSIM.Thermodynamicså®Œæ•´ä»£ç åº“  
**æŠ€æœ¯åŸºç¡€**: åŒ–å·¥çƒ­åŠ›å­¦ç†è®ºä¸æ•°å€¼è®¡ç®—æ–¹æ³•  

---

## ğŸ“‹ ç®—æ³•æ€»è¡¨

| ç±»åˆ« | ç®—æ³•åç§° | åŸå§‹æ–‡ä»¶ | ä»£ç è¡Œæ•° | å¤æ‚åº¦ | åº”ç”¨é¢†åŸŸ | å®ç°çŠ¶æ€ |
|------|----------|----------|----------|--------|----------|----------|
| **é—ªè’¸ç®—æ³•** |
| åµŒå¥—å¾ªç¯ | NestedLoops.vb | 2,396 | é«˜ | æ°”æ¶²å¹³è¡¡ | âœ… å®Œæ•´ |
| Gibbsæœ€å°åŒ– | GibbsMinimization3P.vb | 1,994 | æé«˜ | å¤šç›¸å¹³è¡¡ | âœ… å®Œæ•´ |
| å†…å¤–å¾ªç¯ | BostonBrittInsideOut.vb | 2,312 | é«˜ | åŠ é€Ÿæ”¶æ•› | âœ… å®Œæ•´ |
| ä¸‰ç›¸åµŒå¥—å¾ªç¯ | NestedLoops3PV3.vb | 2,059 | æé«˜ | æ¶²æ¶²åˆ†ç›¸ | ğŸ”„ éƒ¨åˆ† |
| æ¶²æ¶²åˆ†ç›¸ | SimpleLLE.vb | 1,202 | é«˜ | èƒå–åˆ†ç¦» | ğŸ”„ éƒ¨åˆ† |
| ç”µè§£è´¨é—ªè’¸ | ElectrolyteSVLE.vb | 1,338 | æé«˜ | ç”µè§£è´¨ä½“ç³» | âŒ æœªå®ç° |
| **çŠ¶æ€æ–¹ç¨‹** |
| Peng-Robinson | PengRobinson.vb | 1,073 | ä¸­ | çƒ·çƒƒä½“ç³» | âœ… å®Œæ•´ |
| SRK | SoaveRedlichKwong.vb | 1,121 | ä¸­ | è½»çƒƒä½“ç³» | âœ… å®Œæ•´ |
| Lee-Kesler-Plocker | LeeKeslerPlocker.vb | 671 | ä¸­ | å¯¹åº”æ€ | ğŸ”„ æ–°å¢ |
| PRSV2 | PengRobinsonStryjekVera2.vb | 867 | é«˜ | ææ€§åŒ–åˆç‰© | ğŸ”„ æ–°å¢ |
| PC-SAFT | æ—  | - | é«˜ | ç¼”åˆæµä½“ | âœ… åˆ›æ–° |
| **æ´»åŠ¨ç³»æ•°æ¨¡å‹** |
| NRTL | NRTL.vb | 102 | ä¸­ | æ¶²æ¶²å¹³è¡¡ | âœ… å®Œæ•´ |
| UNIQUAC | UNIQUAC.vb | 128 | ä¸­ | åˆ†å­å¤§å°å·®å¼‚ | âœ… å®Œæ•´ |
| UNIFAC | UNIFAC.vb | 136 | é«˜ | åŸºå›¢è´¡çŒ® | âœ… å®Œæ•´ |
| Wilson | åŸºç¡€å®ç° | - | ä¸­ | å®Œå…¨äº’æº¶ | âœ… å¢å¼º |
| **ç›¸ç¨³å®šæ€§åˆ†æ** |
| Michelsenç¨³å®šæ€§ | MichelsenBase.vb | 2,933 | æé«˜ | ç›¸åˆ†ç¦»é¢„æµ‹ | âœ… æ–°å¢ |
| TPDå‡½æ•° | å†…ç½® | - | é«˜ | ç¨³å®šæ€§åˆ¤æ® | âœ… æ–°å¢ |
| **ç‰¹æ®Šç®—æ³•** |
| è’¸æ±½è¡¨ | SteamTables.vb | 1,229 | é«˜ | æ°´è’¸æ°”æ€§è´¨ | âœ… å®Œæ•´ |
| é»‘æ²¹æ¨¡å‹ | BlackOil.vb | 634 | é«˜ | çŸ³æ²¹å·¥ä¸š | âŒ æœªå®ç° |
| æµ·æ°´æ¨¡å‹ | SeaWater.vb | 723 | ä¸­ | æµ·æ´‹å·¥ç¨‹ | âŒ æœªå®ç° |
| é…¸æ€§æ°”ä½“ | SourWater.vb | 1,055 | é«˜ | é…¸æ€§æ°”å¤„ç† | âŒ æœªå®ç° |

---

## 1. é—ªè’¸ç®—æ³• (Flash Algorithms)

### 1.1 åµŒå¥—å¾ªç¯é—ªè’¸ç®—æ³• (Nested Loops)

#### æ•°å­¦åŸºç¡€
**Rachford-Riceæ–¹ç¨‹**:
$$\sum_{i=1}^{n} \frac{z_i(K_i - 1)}{1 + \beta(K_i - 1)} = 0$$

**ç»„æˆè®¡ç®—**:
$$\begin{aligned}
x_i &= \frac{z_i}{1 + \beta(K_i - 1)} \\
y_i &= K_i x_i
\end{aligned}$$

**å¹³è¡¡å¸¸æ•°è¿­ä»£**:
$$K_i^{(k+1)} = \frac{\phi_i^L(T, P, \mathbf{x})}{\phi_i^V(T, P, \mathbf{y})}$$

#### ç®—æ³•æè¿°
åµŒå¥—å¾ªç¯ç®—æ³•æ˜¯æ°”æ¶²å¹³è¡¡è®¡ç®—çš„ç»å…¸æ–¹æ³•ï¼ŒåŒ…å«å†…å¤–ä¸¤å±‚å¾ªç¯ï¼š
- **å¤–å¾ªç¯**: æ›´æ–°å¹³è¡¡å¸¸æ•°Kå€¼
- **å†…å¾ªç¯**: æ±‚è§£Rachford-Riceæ–¹ç¨‹å¾—åˆ°æ°”åŒ–ç‡Î²

#### æ”¶æ•›å‡†åˆ™
```latex
\max_i |K_i^{(k+1)} - K_i^{(k)}| < \varepsilon
```

#### åº”ç”¨èŒƒå›´
- çŸ³æ²¹åŒ–å·¥åˆ†ç¦»è¿‡ç¨‹
- ç²¾é¦å¡”è®¾è®¡
- é—ªè’¸å™¨è®¡ç®—
- ç›¸åŒ…ç»œçº¿ç»˜åˆ¶

#### ä¼˜ç¼ºç‚¹
**ä¼˜ç‚¹**: 
- ç®—æ³•ç¨³å®šå¯é 
- æ˜“äºç†è§£å®ç°
- é€‚ç”¨èŒƒå›´å¹¿

**ç¼ºç‚¹**:
- æ”¶æ•›é€Ÿåº¦è¾ƒæ…¢
- éœ€è¦è‰¯å¥½åˆå€¼
- å¯¹éç†æƒ³ä½“ç³»æ•æ„Ÿ

---

### 1.2 Gibbsè‡ªç”±èƒ½æœ€å°åŒ–ç®—æ³•

#### æ•°å­¦åŸºç¡€
**ç›®æ ‡å‡½æ•°**:
```latex
\min G = \sum_{k=1}^{F} \sum_{i=1}^{C} n_{ik} \mu_{ik}
```

**åŒ–å­¦åŠ¿è¡¨è¾¾å¼**:
```latex
\mu_{ik} = \mu_i^{\circ}(T,P) + RT \ln(x_{ik} \gamma_{ik})
```

**çº¦æŸæ¡ä»¶**:
```latex
\begin{aligned}
\sum_{k=1}^{F} n_{ik} &= z_i F \quad \forall i \\
n_{ik} &\geq 0 \quad \forall i,k \\
\sum_{i=1}^{C} x_{ik} &= 1 \quad \forall k
\end{aligned}
```

**Lagrangeå‡½æ•°**:
```latex
L = G + \sum_{i=1}^{C} \lambda_i \left(z_i F - \sum_{k=1}^{F} n_{ik}\right)
```

#### ç®—æ³•æè¿°
Gibbsæœ€å°åŒ–ç®—æ³•é€šè¿‡æœ€å°åŒ–ç³»ç»Ÿæ€»Gibbsè‡ªç”±èƒ½æ¥ç¡®å®šå¹³è¡¡æ€ï¼Œç‰¹åˆ«é€‚ç”¨äºï¼š
- å¤šç›¸å¹³è¡¡è®¡ç®—
- ç›¸ç¨³å®šæ€§åˆ†æ
- åŒ–å­¦ååº”å¹³è¡¡
- å¤æ‚ä½“ç³»ç›¸åˆ†ç¦»

#### ä¼˜åŒ–æ–¹æ³•
1. **Newton-Raphsonæ³•**
2. **æ‹ŸNewtonæ³•** (BFGS, L-BFGS)
3. **ä¿¡èµ–åŸŸæ³•**
4. **åºåˆ—äºŒæ¬¡è§„åˆ’** (SQP)

#### åº”ç”¨èŒƒå›´
- æ¶²æ¶²åˆ†ç›¸
- æ°”æ¶²æ¶²ä¸‰ç›¸å¹³è¡¡
- å›ºæ¶²å¹³è¡¡
- è¶…ä¸´ç•Œèƒå–

---

### 1.3 å†…å¤–å¾ªç¯ç®—æ³• (Inside-Out)

#### æ•°å­¦åŸºç¡€
**Kå€¼æ›´æ–°æ–¹ç¨‹**:
```latex
K_i^{(k+1)} = K_i^{(k)} \frac{\phi_i^L(T, P, \mathbf{x}^{(k)})}{\phi_i^V(T, P, \mathbf{y}^{(k)})}
```

**åŠ é€Ÿå› å­**:
```latex
K_i^{(k+1)} = K_i^{(k)} \left(\frac{\phi_i^L}{\phi_i^V}\right)^{\alpha}
```

å…¶ä¸­ $\alpha$ ä¸ºè‡ªé€‚åº”åŠ é€Ÿå› å­ã€‚

**ç›¸ç»„æˆæ›´æ–°**:
```latex
\begin{aligned}
x_i^{(k+1)} &= \frac{z_i}{1 + \beta^{(k)}(K_i^{(k+1)} - 1)} \\
y_i^{(k+1)} &= K_i^{(k+1)} x_i^{(k+1)}
\end{aligned}
```

#### ç®—æ³•æè¿°
å†…å¤–å¾ªç¯ç®—æ³•æ˜¯å¯¹åµŒå¥—å¾ªç¯çš„æ”¹è¿›ï¼Œé€šè¿‡ä»¥ä¸‹ç­–ç•¥æé«˜æ”¶æ•›é€Ÿåº¦ï¼š
- ä½¿ç”¨çŠ¶æ€æ–¹ç¨‹è®¡ç®—é€¸åº¦ç³»æ•°
- è‡ªé€‚åº”æ­¥é•¿æ§åˆ¶
- æ”¶æ•›åŠ é€ŸæŠ€æœ¯

#### æ”¶æ•›åŠ é€ŸæŠ€æœ¯
1. **Aitkenå¤–æ¨æ³•**
2. **Steffensenè¿­ä»£**
3. **Andersonæ··åˆ**
4. **DIISç®—æ³•**

---

### 1.4 ç›¸ç¨³å®šæ€§åˆ†æ (Michelsen Algorithm)

#### æ•°å­¦åŸºç¡€
**åˆ‡çº¿å¹³é¢è·ç¦»å‡½æ•° (TPD)**:
```latex
TPD(\mathbf{n}) = \sum_{i=1}^{C} n_i [\ln f_i(\mathbf{n}) - \ln f_i^{ref}(\mathbf{z})]
```

**ç¨³å®šæ€§åˆ¤æ®**:
```latex
\begin{cases}
TPD_{min} < 0 & \text{ç›¸ä¸ç¨³å®šï¼Œå­˜åœ¨ç›¸åˆ†ç¦»} \\
TPD_{min} \geq 0 & \text{ç›¸ç¨³å®š}
\end{cases}
```

**è¯•éªŒç›¸ç»„æˆä¼˜åŒ–**:
```latex
W_i = \frac{\partial TPD}{\partial n_i} = \ln f_i(\mathbf{n}) - \ln f_i^{ref}(\mathbf{z})
```

**Newton-Raphsonè¿­ä»£**:
```latex
\mathbf{n}^{(k+1)} = \mathbf{n}^{(k)} - \alpha \mathbf{H}^{-1} \nabla TPD
```

å…¶ä¸­ $\mathbf{H}$ ä¸ºHessiançŸ©é˜µã€‚

#### ç®—æ³•æè¿°
Michelsenç›¸ç¨³å®šæ€§åˆ†æç”¨äºåˆ¤æ–­ç»™å®šæ¡ä»¶ä¸‹ç›¸çš„ç¨³å®šæ€§ï¼š
1. ç”Ÿæˆå¤šä¸ªè¯•éªŒç›¸åˆå€¼
2. å¯¹æ¯ä¸ªè¯•éªŒç›¸æœ€å°åŒ–TPDå‡½æ•°
3. åˆ¤æ–­ç¨³å®šæ€§å¹¶è¯†åˆ«æ–°ç›¸

#### è¯•éªŒç›¸ç”Ÿæˆç­–ç•¥
1. **Wilson Kå€¼ä¼°ç®—**
2. **çº¯ç»„åˆ†è¯•éªŒç›¸**
3. **éšæœºæ‰°åŠ¨ç»„æˆ**
4. **å†å²è§£æ‰°åŠ¨**

---

## 2. çŠ¶æ€æ–¹ç¨‹ (Equations of State)

### 2.1 Peng-RobinsonçŠ¶æ€æ–¹ç¨‹

#### æ•°å­¦åŸºç¡€
**çŠ¶æ€æ–¹ç¨‹**:
```latex
P = \frac{RT}{V-b} - \frac{a(T)}{V(V+b) + b(V-b)}
```

**å‚æ•°è®¡ç®—**:
```latex
\begin{aligned}
a_c &= 0.45724 \frac{(RT_c)^2}{P_c} \\
b_c &= 0.07780 \frac{RT_c}{P_c} \\
a(T) &= a_c \alpha(T_r) \\
\alpha(T_r) &= [1 + \kappa(1-\sqrt{T_r})]^2
\end{aligned}
```

**Îºå‚æ•°**:
```latex
\kappa = \begin{cases}
0.37464 + 1.54226\omega - 0.26992\omega^2 & \omega \leq 0.491 \\
0.379642 + 1.48503\omega - 0.164423\omega^2 + 0.016666\omega^3 & \omega > 0.491
\end{cases}
```

#### æ··åˆè§„åˆ™
**van der Waalsæ··åˆè§„åˆ™**:
```latex
\begin{aligned}
a_m &= \sum_i \sum_j x_i x_j \sqrt{a_i a_j}(1 - k_{ij}) \\
b_m &= \sum_i x_i b_i
\end{aligned}
```

#### é€¸åº¦ç³»æ•°
```latex
\ln \phi_i = \frac{b_i}{b_m}(Z-1) - \ln(Z-B) - \frac{A}{2\sqrt{2}B}\left(\frac{2\sum_j x_j a_{ij}}{a_m} - \frac{b_i}{b_m}\right)\ln\left(\frac{Z + (1+\sqrt{2})B}{Z + (1-\sqrt{2})B}\right)
```

#### åº”ç”¨èŒƒå›´
- çƒ·çƒƒå’Œè½»çƒƒ
- æ°”æ¶²å¹³è¡¡
- ä¸´ç•Œæ€§è´¨é¢„æµ‹
- é«˜å‹ç³»ç»Ÿ

---

### 2.2 Soave-Redlich-KwongçŠ¶æ€æ–¹ç¨‹

#### æ•°å­¦åŸºç¡€
**çŠ¶æ€æ–¹ç¨‹**:
```latex
P = \frac{RT}{V-b} - \frac{a(T)}{V(V+b)}
```

**Î±å‡½æ•°**:
```latex
\alpha(T_r) = [1 + m(1-\sqrt{T_r})]^2
```

**må‚æ•°**:
```latex
m = 0.480 + 1.574\omega - 0.176\omega^2
```

#### åº”ç”¨ç‰¹ç‚¹
- é€‚ç”¨äºææ€§åŒ–åˆç‰©
- è‰¯å¥½çš„æ°”ç›¸å¯†åº¦é¢„æµ‹
- å¹¿æ³›çš„æ¸©åº¦å‹åŠ›èŒƒå›´

---

### 2.3 Lee-Kesler-PlockerçŠ¶æ€æ–¹ç¨‹

#### æ•°å­¦åŸºç¡€
**å¯¹åº”æ€åŸç†**:
```latex
Z = Z^{(0)} + \omega Z^{(1)} + Z^{(2)}
```

å…¶ä¸­ï¼š
- $Z^{(0)}$: ç®€å•æµä½“å‹ç¼©å› å­
- $Z^{(1)}$: å‚è€ƒæµä½“ä¿®æ­£
- $Z^{(2)}$: Plockerä¿®æ­£é¡¹

**ç®€å•æµä½“ç»´é‡Œå±•å¼€**:
```latex
Z^{(0)} = 1 + B^{(0)}\rho_r + C^{(0)}\rho_r^2 + D^{(0)}\rho_r^5
```

**ç»´é‡Œç³»æ•°**:
```latex
\begin{aligned}
B^{(0)} &= \sum_{i=1}^{4} b_i^{(0)} T_r^{-\gamma_i} \\
C^{(0)} &= \sum_{i=5}^{7} b_i^{(0)} T_r^{-\gamma_i} \\
D^{(0)} &= \sum_{i=8}^{11} b_i^{(0)} T_r^{-\gamma_i}
\end{aligned}
```

#### åº”ç”¨èŒƒå›´
- çŸ³æ²¹å¤©ç„¶æ°”å·¥ä¸š
- çƒ·çƒƒæ··åˆç‰©
- å·¥è‰ºæ¨¡æ‹Ÿè®¡ç®—

---

### 2.4 PC-SAFTçŠ¶æ€æ–¹ç¨‹

#### æ•°å­¦åŸºç¡€
**å‹ç¼©å› å­**:
```latex
Z = 1 + Z^{hc} + Z^{disp} + Z^{assoc}
```

**ç¡¬é“¾è´¡çŒ®**:
```latex
Z^{hc} = m \frac{4\eta - 3\eta^2}{(1-\eta)^2}
```

**è‰²æ•£è´¡çŒ®**:
```latex
Z^{disp} = -2\pi\rho \frac{\partial}{\partial \rho}(\rho a_1) - \pi\rho m \frac{\partial}{\partial \rho}[\rho a_2]
```

**ç¼”åˆè´¡çŒ®**:
```latex
Z^{assoc} = \sum_i x_i \sum_{A_i} \left(\frac{1}{X_{A_i}} - \frac{1}{2}\right) \frac{\partial X_{A_i}}{\partial \rho}
```

**ç¼”åˆåº¦æ–¹ç¨‹**:
```latex
X_{A_i} = \frac{1}{1 + \rho \sum_j x_j \sum_{B_j} X_{B_j} \Delta_{A_i B_j}}
```

#### åˆ†å­å‚æ•°
- $m$: é“¾æ®µæ•°
- $\sigma$: é“¾æ®µç›´å¾„ (Ã…)
- $\varepsilon/k$: è‰²æ•£èƒ½ (K)
- $\varepsilon^{AB}/k$: ç¼”åˆèƒ½ (K)
- $\kappa^{AB}$: ç¼”åˆä½“ç§¯

#### åº”ç”¨ä¼˜åŠ¿
- ç¼”åˆæµä½“ (é†‡ã€é…¸ã€èƒº)
- èšåˆç‰©æº¶æ¶²
- ç¦»å­æ¶²ä½“
- ç”Ÿç‰©åˆ†å­

---

## 3. æ´»åŠ¨ç³»æ•°æ¨¡å‹ (Activity Coefficient Models)

### 3.1 NRTLæ¨¡å‹

#### æ•°å­¦åŸºç¡€
**æ´»åŠ¨ç³»æ•°æ–¹ç¨‹**:
```latex
\ln \gamma_i = \frac{\sum_j \tau_{ji} G_{ji} x_j}{\sum_k G_{ki} x_k} + \sum_j \frac{x_j G_{ij}}{\sum_k G_{kj} x_k} \left(\tau_{ij} - \frac{\sum_k x_k \tau_{kj} G_{kj}}{\sum_k G_{kj} x_k}\right)
```

**å‚æ•°å®šä¹‰**:
```latex
\begin{aligned}
G_{ij} &= \exp(-\alpha_{ij} \tau_{ij}) \\
\tau_{ij} &= \frac{g_{ij} - g_{jj}}{RT} = \frac{A_{ij}}{RT} \\
\alpha_{ij} &= \alpha_{ji}
\end{aligned}
```

**å‚æ•°ç‰©ç†æ„ä¹‰**:
- $A_{ij}$: ç›¸äº’ä½œç”¨èƒ½å‚æ•° (cal/mol)
- $\alpha_{ij}$: ééšæœºæ€§å‚æ•° (é€šå¸¸0.2-0.47)

#### åº”ç”¨èŒƒå›´
- æ¶²æ¶²å¹³è¡¡
- æ±½æ¶²å¹³è¡¡
- ææ€§-éææ€§æ··åˆç‰©
- ç”µè§£è´¨ä½“ç³» (e-NRTL)

---

### 3.2 UNIQUACæ¨¡å‹

#### æ•°å­¦åŸºç¡€
**æ´»åŠ¨ç³»æ•°åˆ†ç¦»**:
```latex
\ln \gamma_i = \ln \gamma_i^{combinatorial} + \ln \gamma_i^{residual}
```

**ç»„åˆè´¡çŒ®**:
```latex
\ln \gamma_i^{combinatorial} = \ln \frac{\Phi_i}{x_i} + \frac{z}{2} q_i \ln \frac{\theta_i}{\Phi_i} + l_i - \frac{\Phi_i}{x_i} \sum_j x_j l_j
```

**æ®‹åŸºè´¡çŒ®**:
```latex
\ln \gamma_i^{residual} = q_i \left(1 - \ln \sum_j \theta_j \tau_{ji} - \sum_j \frac{\theta_j \tau_{ij}}{\sum_k \theta_k \tau_{kj}}\right)
```

**é¢ç§¯å’Œä½“ç§¯åˆ†æ•°**:
```latex
\begin{aligned}
\Phi_i &= \frac{r_i x_i}{\sum_j r_j x_j} \\
\theta_i &= \frac{q_i x_i}{\sum_j q_j x_j} \\
l_i &= \frac{z}{2}(r_i - q_i) - (r_i - 1)
\end{aligned}
```

**ç›¸äº’ä½œç”¨å‚æ•°**:
```latex
\tau_{ij} = \exp\left(-\frac{u_{ij} - u_{jj}}{RT}\right)
```

#### åˆ†å­å‚æ•°
- $r_i$: åˆ†å­ä½“ç§¯å‚æ•°
- $q_i$: åˆ†å­è¡¨é¢ç§¯å‚æ•°
- $u_{ij}$: ç›¸äº’ä½œç”¨èƒ½ (cal/mol)

#### åº”ç”¨ç‰¹ç‚¹
- è€ƒè™‘åˆ†å­å¤§å°å·®å¼‚
- é€‚ç”¨äºèšåˆç‰©æº¶æ¶²
- è‰¯å¥½çš„å¤–æ¨æ€§èƒ½

---

### 3.3 UNIFACæ¨¡å‹

#### æ•°å­¦åŸºç¡€
**åŸºå›¢è´¡çŒ®æ³•**:
```latex
\ln \gamma_i = \ln \gamma_i^{(C)} + \ln \gamma_i^{(R)}
```

**ç»„åˆè´¡çŒ®** (UNIQUACå½¢å¼):
```latex
\ln \gamma_i^{(C)} = \ln \frac{\Phi_i}{x_i} + \frac{z}{2} q_i \ln \frac{\theta_i}{\Phi_i} + l_i - \frac{\Phi_i}{x_i} \sum_j x_j l_j
```

**æ®‹åŸºè´¡çŒ®**:
```latex
\ln \gamma_i^{(R)} = \sum_k \nu_k^{(i)} [\ln \Gamma_k - \ln \Gamma_k^{(i)}]
```

**åŸºå›¢æ´»åº¦ç³»æ•°**:
```latex
\ln \Gamma_k = Q_k \left(1 - \ln \sum_m \Theta_m \Psi_{mk} - \sum_m \frac{\Theta_m \Psi_{km}}{\sum_n \Theta_n \Psi_{mn}}\right)
```

**åŸºå›¢åˆ†æ•°**:
```latex
\begin{aligned}
X_m &= \frac{\sum_j \nu_m^{(j)} x_j}{\sum_j \sum_n \nu_n^{(j)} x_j} \\
\Theta_m &= \frac{Q_m X_m}{\sum_n Q_n X_n}
\end{aligned}
```

**åŸºå›¢ç›¸äº’ä½œç”¨**:
```latex
\Psi_{mn} = \exp\left(-\frac{a_{mn}}{T}\right)
```

#### åŸºå›¢å‚æ•°
- $R_k$: åŸºå›¢ä½“ç§¯å‚æ•°
- $Q_k$: åŸºå›¢è¡¨é¢ç§¯å‚æ•°
- $a_{mn}$: åŸºå›¢ç›¸äº’ä½œç”¨å‚æ•° (K)

#### åº”ç”¨ä¼˜åŠ¿
- é¢„æµ‹æ€§æ¨¡å‹
- æ•°æ®åº“ä¸°å¯Œ
- é€‚ç”¨äºå¤æ‚æ··åˆç‰©
- å·¥ç¨‹è®¾è®¡é¦–é€‰

---

### 3.4 Wilsonæ¨¡å‹

#### æ•°å­¦åŸºç¡€
**æ´»åŠ¨ç³»æ•°æ–¹ç¨‹**:
```latex
\ln \gamma_i = -\ln\left(\sum_j x_j \Lambda_{ij}\right) + 1 - \sum_j \frac{x_j \Lambda_{ji}}{\sum_k x_k \Lambda_{jk}}
```

**Wilsonå‚æ•°**:
```latex
\Lambda_{ij} = \frac{V_j^L}{V_i^L} \exp\left(-\frac{\lambda_{ij} - \lambda_{ii}}{RT}\right)
```

**å±€éƒ¨ä½“ç§¯åˆ†æ•°**:
```latex
\Lambda_{ij} = \Lambda_{ji} \frac{V_j^L}{V_i^L}
```

#### åº”ç”¨é™åˆ¶
- ä»…é€‚ç”¨äºå®Œå…¨äº’æº¶ä½“ç³»
- ä¸èƒ½é¢„æµ‹æ¶²æ¶²åˆ†ç›¸
- å‚æ•°å…·æœ‰æ¸©åº¦ä¾èµ–æ€§

---

## 4. çƒ­åŠ›å­¦æ€§è´¨è®¡ç®—

### 4.1 ç„“è®¡ç®—

#### ç†æƒ³æ°”ä½“ç„“
```latex
H_{ig}(T) = \int_{T_{ref}}^{T} C_p^{ig}(T) dT
```

**å¤šé¡¹å¼å½¢å¼**:
```latex
C_p^{ig} = A + BT + CT^2 + DT^3 + ET^4
```

#### ç„“åå·®
**çŠ¶æ€æ–¹ç¨‹æ³•**:
```latex
H^R = RT^2 \left(\frac{\partial Z}{\partial T}\right)_{P,\mathbf{n}} - RT(Z-1)
```

**æ´»åŠ¨ç³»æ•°æ³•**:
```latex
H^E = -RT^2 \sum_i x_i \left(\frac{\partial \ln \gamma_i}{\partial T}\right)_{P,\mathbf{x}}
```

### 4.2 ç†µè®¡ç®—

#### ç†æƒ³æ°”ä½“ç†µ
```latex
S_{ig}(T,P) = \int_{T_{ref}}^{T} \frac{C_p^{ig}(T)}{T} dT - R \ln\left(\frac{P}{P_{ref}}\right)
```

#### ç†µåå·®
```latex
S^R = R \ln Z + \int_{\infty}^{V} \left[\frac{\partial P}{\partial T}\right]_{V,\mathbf{n}} \frac{dV}{V} - R \ln Z
```

### 4.3 Gibbsè‡ªç”±èƒ½

#### æ ‡å‡†Gibbsè‡ªç”±èƒ½
```latex
G^{\circ}(T) = H^{\circ}(T) - TS^{\circ}(T)
```

#### åŒ–å­¦åŠ¿
```latex
\mu_i = \mu_i^{\circ}(T,P) + RT \ln(a_i)
```

å…¶ä¸­æ´»åº¦ $a_i = x_i \gamma_i$ï¼ˆæ¶²ç›¸ï¼‰æˆ– $a_i = \hat{\phi}_i P y_i$ï¼ˆæ°”ç›¸ï¼‰ã€‚

---

## 5. æ•°å€¼æ–¹æ³•ä¸æ”¶æ•›æŠ€æœ¯

### 5.1 Newton-Raphsonæ–¹æ³•

#### ä¸€ç»´æƒ…å½¢
```latex
x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)}
```

#### å¤šç»´æƒ…å½¢
```latex
\mathbf{x}_{k+1} = \mathbf{x}_k - \mathbf{J}^{-1}(\mathbf{x}_k) \mathbf{f}(\mathbf{x}_k)
```

å…¶ä¸­ $\mathbf{J}$ ä¸ºJacobiançŸ©é˜µã€‚

### 5.2 Broydenæ–¹æ³•

**å‡†Newtonæ›´æ–°**:
```latex
\mathbf{B}_{k+1} = \mathbf{B}_k + \frac{(\mathbf{y}_k - \mathbf{B}_k \mathbf{s}_k)\mathbf{s}_k^T}{\mathbf{s}_k^T \mathbf{s}_k}
```

å…¶ä¸­ï¼š
- $\mathbf{s}_k = \mathbf{x}_{k+1} - \mathbf{x}_k$
- $\mathbf{y}_k = \mathbf{f}(\mathbf{x}_{k+1}) - \mathbf{f}(\mathbf{x}_k)$

### 5.3 æ”¶æ•›åŠ é€Ÿ

#### Aitken Î”Â²å¤–æ¨
```latex
x_{acc} = x_k - \frac{(\Delta x_k)^2}{\Delta^2 x_k}
```

å…¶ä¸­ï¼š
- $\Delta x_k = x_{k+1} - x_k$
- $\Delta^2 x_k = \Delta x_{k+1} - \Delta x_k$

---

## 6. ç‰¹æ®Šç®—æ³•

### 6.1 è’¸æ±½è¡¨ç®—æ³• (IAPWS-IF97)

#### åŸºæœ¬æ–¹ç¨‹
**Region 1 (æ¶²ä½“)**:
```latex
\gamma(\pi,\tau) = \sum_{i=1}^{34} n_i \pi^{I_i} \tau^{J_i}
```

**Region 2 (è’¸æ±½)**:
```latex
\gamma^{\circ}(\pi,\tau) = \ln(\pi) + \sum_{i=1}^{9} n_i^{\circ} \tau^{J_i^{\circ}}
```

**æ— é‡çº²å˜é‡**:
```latex
\begin{aligned}
\pi &= \frac{P}{P^*} \\
\tau &= \frac{T^*}{T}
\end{aligned}
```

#### æ€§è´¨è®¡ç®—
```latex
\begin{aligned}
v &= \pi \left(\frac{\partial \gamma}{\partial \pi}\right)_{\tau} \frac{RT}{P} \\
h &= \tau \left(\frac{\partial \gamma}{\partial \tau}\right)_{\pi} RT \\
s &= \left[\tau \left(\frac{\partial \gamma}{\partial \tau}\right)_{\pi} - \gamma\right] R
\end{aligned}
```

### 6.2 ç”µè§£è´¨ä½“ç³»ç®—æ³•

#### Debye-HÃ¼ckelç†è®º
**æ´»åº¦ç³»æ•°**:
```latex
\ln \gamma_i = -A_{\gamma} z_i^2 \frac{\sqrt{I}}{1 + B a_i \sqrt{I}}
```

**ç¦»å­å¼ºåº¦**:
```latex
I = \frac{1}{2} \sum_i m_i z_i^2
```

#### Pitzeræ–¹ç¨‹
```latex
\ln \gamma_{\pm} = f^{\gamma} + m B^{\gamma} + m^2 C^{\gamma}
```

å…¶ä¸­å„é¡¹åŒ…å«å¤æ‚çš„ç¦»å­ç›¸äº’ä½œç”¨å‚æ•°ã€‚

### 6.3 é»‘æ²¹æ¨¡å‹

#### æ°”æ²¹æ¯”è®¡ç®—
```latex
R_s = \gamma_g \left(\frac{P}{P_{sc}}\right)^{1.2048} \left(\frac{T + 459.67}{T_{sc} + 459.67}\right)^{-1.8} \times 10^{A}
```

å…¶ä¸­ï¼š
```latex
A = -0.0000000061 (\text{API})^{1.8}
```

#### åœ°å±‚ä½“ç§¯å› å­
```latex
B_o = 1.0 + 0.000147 \left[R_s \sqrt{\frac{\gamma_g}{\gamma_o}} + 1.25 T\right]^{1.175}
```

---

## 7. ç®—æ³•é€‰æ‹©æŒ‡å—

### 7.1 é—ªè’¸ç®—æ³•é€‰æ‹©

| ä½“ç³»ç±»å‹ | æ¨èç®—æ³• | ç†ç”± |
|----------|----------|------|
| ç†æƒ³ä½“ç³» | åµŒå¥—å¾ªç¯ | ç®€å•å¯é  |
| éç†æƒ³ä½“ç³» | å†…å¤–å¾ªç¯ | æ”¶æ•›å¿«é€Ÿ |
| å¤šç›¸å¹³è¡¡ | Gibbsæœ€å°åŒ– | ç†è®ºä¸¥æ ¼ |
| æ¥è¿‘ä¸´ç•Œç‚¹ | Gibbsæœ€å°åŒ– | æ•°å€¼ç¨³å®š |
| æ¶²æ¶²åˆ†ç›¸ | ä¸‰ç›¸é—ªè’¸ | ä¸“é—¨è®¾è®¡ |

### 7.2 çŠ¶æ€æ–¹ç¨‹é€‰æ‹©

| åŒ–åˆç‰©ç±»å‹ | æ¨èEOS | é€‚ç”¨èŒƒå›´ |
|------------|---------|----------|
| è½»çƒƒ | SRK | < 10 MPa |
| é‡çƒƒ | PR | å¹¿æ³›é€‚ç”¨ |
| ææ€§åŒ–åˆç‰© | PRSV2 | æ”¹è¿›ç²¾åº¦ |
| ç¼”åˆæµä½“ | PC-SAFT | æ°¢é”®ä½“ç³» |
| å¤©ç„¶æ°” | Lee-Kesler | å·¥ä¸šæ ‡å‡† |

### 7.3 æ´»åŠ¨ç³»æ•°æ¨¡å‹é€‰æ‹©

| æ··åˆç‰©ç±»å‹ | æ¨èæ¨¡å‹ | åº”ç”¨æ¡ä»¶ |
|------------|----------|----------|
| å®Œå…¨äº’æº¶ | Wilson | æ— æ¶²æ¶²åˆ†ç›¸ |
| éƒ¨åˆ†äº’æº¶ | NRTL | æœ‰å®éªŒæ•°æ® |
| å¤§å°å·®å¼‚å¤§ | UNIQUAC | èšåˆç‰©æº¶æ¶² |
| æœªçŸ¥ä½“ç³» | UNIFAC | é¢„æµ‹è®¡ç®— |

---

## 8. æ€§èƒ½ä¼˜åŒ–ä¸å¹¶è¡ŒåŒ–

### 8.1 è®¡ç®—å¤æ‚åº¦

| ç®—æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | å¤‡æ³¨ |
|------|------------|------------|------|
| åµŒå¥—å¾ªç¯ | O(nÂ·m) | O(n) | n=ç»„åˆ†æ•°ï¼Œm=è¿­ä»£æ¬¡æ•° |
| Gibbsæœ€å°åŒ– | O(nÂ³) | O(nÂ²) | éœ€æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ |
| ç¨³å®šæ€§åˆ†æ | O(pÂ·nÂ³) | O(nÂ²) | p=è¯•éªŒç›¸æ•° |
| UNIFAC | O(gÂ²) | O(g) | g=åŸºå›¢æ•° |

### 8.2 å¹¶è¡ŒåŒ–ç­–ç•¥

#### æ•°æ®å¹¶è¡Œ
- å¤šç»„åˆ†é€¸åº¦ç³»æ•°åŒæ—¶è®¡ç®—
- å¤šä¸ªè¯•éªŒç›¸å¹¶è¡Œä¼˜åŒ–
- æ‰¹é‡é—ªè’¸è®¡ç®—

#### ä»»åŠ¡å¹¶è¡Œ
- ç¨³å®šæ€§æµ‹è¯•ä¸é—ªè’¸è®¡ç®—æµæ°´çº¿
- å¤šç§ç®—æ³•åŒæ—¶å°è¯•
- å‚æ•°æ•æ„Ÿæ€§åˆ†æ

### 8.3 å†…å­˜ä¼˜åŒ–

#### ç¼“å­˜ç­–ç•¥
```latex
\text{ç¼“å­˜å‘½ä¸­ç‡} = \frac{\text{ç¼“å­˜å‘½ä¸­æ¬¡æ•°}}{\text{æ€»è®¿é—®æ¬¡æ•°}}
```

#### æ•°æ®ç»“æ„ä¼˜åŒ–
- ç¨€ç–çŸ©é˜µå­˜å‚¨
- å†…å­˜æ± ç®¡ç†
- æ•°æ®å±€éƒ¨æ€§ä¼˜åŒ–

---

## 9. è¯¯å·®åˆ†æä¸ç²¾åº¦æ§åˆ¶

### 9.1 æ•°å€¼è¯¯å·®æ¥æº

1. **æˆªæ–­è¯¯å·®**: ç®—æ³•è¿‘ä¼¼å¼•èµ·
2. **èˆå…¥è¯¯å·®**: æµ®ç‚¹è¿ç®—ç´¯ç§¯
3. **å»ºæ¨¡è¯¯å·®**: ç‰©ç†æ¨¡å‹ç®€åŒ–
4. **å‚æ•°è¯¯å·®**: å®éªŒæ•°æ®ä¸ç¡®å®šæ€§

### 9.2 è¯¯å·®ä¼ æ’­

**çº¿æ€§åŒ–è¯¯å·®ä¼ æ’­**:
```latex
\sigma_f^2 \approx \sum_i \left(\frac{\partial f}{\partial x_i}\right)^2 \sigma_{x_i}^2
```

### 9.3 æ”¶æ•›å‡†åˆ™

#### ç»å¯¹è¯¯å·®
```latex
|\mathbf{x}_{k+1} - \mathbf{x}_k| < \varepsilon_{abs}
```

#### ç›¸å¯¹è¯¯å·®
```latex
\frac{|\mathbf{x}_{k+1} - \mathbf{x}_k|}{|\mathbf{x}_k|} < \varepsilon_{rel}
```

#### å‡½æ•°å€¼æ”¶æ•›
```latex
|\mathbf{f}(\mathbf{x}_k)| < \varepsilon_{fun}
```

---

## 10. ç®—æ³•éªŒè¯ä¸åŸºå‡†æµ‹è¯•

### 10.1 éªŒè¯æ–¹æ³•

1. **è§£æè§£éªŒè¯**: ç®€å•ä½“ç³»ç²¾ç¡®è§£å¯¹æ¯”
2. **å®éªŒæ•°æ®éªŒè¯**: ä¸æ–‡çŒ®å®éªŒæ•°æ®å¯¹æ¯”
3. **è½¯ä»¶äº¤å‰éªŒè¯**: ä¸å•†ä¸šè½¯ä»¶ç»“æœå¯¹æ¯”
4. **ç‰©ç†çº¦æŸæ£€éªŒ**: çƒ­åŠ›å­¦å®šå¾‹ç¬¦åˆæ€§

### 10.2 åŸºå‡†æ•°æ®é›†

| ä½“ç³» | æ•°æ®æ¥æº | ç²¾åº¦è¦æ±‚ |
|------|----------|----------|
| çƒ·çƒƒVLE | NIST Webbook | < 1% |
| é†‡æ°´ä½“ç³» | DECHEMA | < 2% |
| ä¸´ç•Œæ€§è´¨ | API Project 44 | < 0.5% |
| é«˜å‹æ•°æ® | PPDS | < 3% |

### 10.3 æ€§èƒ½æŒ‡æ ‡

#### è®¡ç®—ç²¾åº¦
```latex
\text{AAD} = \frac{1}{N} \sum_{i=1}^{N} \left|\frac{x_{calc,i} - x_{exp,i}}{x_{exp,i}}\right| \times 100\%
```

#### è®¡ç®—æ•ˆç‡
```latex
\text{åŠ é€Ÿæ¯”} = \frac{T_{serial}}{T_{parallel}}
```

---

## é™„å½•ï¼šå‚è€ƒæ–‡çŒ®ä¸æ ‡å‡†

### A.1 åŸºç¡€ç†è®º
1. Prausnitz, J.M., et al. "Molecular Thermodynamics of Fluid-Phase Equilibria"
2. Michelsen, M.L., Mollerup, J.M. "Thermodynamic Models: Fundamentals & Computational Aspects"
3. Sandler, S.I. "Chemical, Biochemical, and Engineering Thermodynamics"

### A.2 ç®—æ³•æ–‡çŒ®
1. Rachford, H.H., Rice, J.D. "Procedure for Use of Electronic Digital Computers in Calculating Flash Vaporization Hydrocarbon Equilibrium" (1952)
2. Michelsen, M.L. "The isothermal flash problem. Part I. Stability" (1982)
3. Gmehling, J., et al. "A modified UNIFAC model" (1993)

### A.3 å›½é™…æ ‡å‡†
1. IAPWS-IF97: "Industrial Formulation 1997 for the Thermodynamic Properties of Water and Steam"
2. ISO 20765: "Natural gas â€” Calculation of thermodynamic properties"
3. ASTM D4815: "Standard Test Method for Determination of MTBE, ETBE, TAME, DIPE, and Aromatics in Gasoline"

---

**æ–‡æ¡£ç¼–åˆ¶**: OpenAspené¡¹ç›®ç»„  
**æŠ€æœ¯å®¡æ ¸**: çƒ­åŠ›å­¦è®¡ç®—ä¸“å®¶å§”å‘˜ä¼š  
**ç‰ˆæœ¬æ§åˆ¶**: Gitç®¡ç†ï¼ŒæŒç»­æ›´æ–°  
**ä½¿ç”¨è®¸å¯**: å¼€æºMITè®¸å¯è¯  

*æœ¬æ–‡æ¡£åŸºäºDWSIM.Thermodynamicså®Œæ•´ä»£ç åº“åˆ†æç¼–åˆ¶ï¼Œä¸ºçƒ­åŠ›å­¦è®¡ç®—æä¾›æƒå¨çš„ç®—æ³•å‚è€ƒå’Œå®æ–½æŒ‡å—ã€‚* 